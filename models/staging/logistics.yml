version: 2

sources:
  - name: customer
    database: raw
    schema: customer
    tables:
      - name: location_registered
        columns:
          - name: customerid,
            tests:
              - unique
              - not null
              - relationships:
                  to: ref('stg_customer_registered') # as per data model
                  field: customerid
          - name: contactphonenumber
            tests:
              - not_null
          - name: occurredat
            tests:
              - not_null

                 
# additional test depending on business requirement: 
  #location exists within African boundaries
  #contact details format consistency
  #duplicate coordinates within reasonable radius

models:
 
      - name: location_registered
        columns:
          - name: customerid,
            tests:
              - unique
              - not null
              - relationships:
                  to: ref('stg_customer_registered')
                  field: customerid
          - name: contactphonenumber
            tests:
              - not_null
          - name: occurredat
            tests:
              - not_null

 

